(()=>{"use strict";var e={672:e=>{var t=Object.prototype.hasOwnProperty,r="function"==typeof WeakMap?new WeakMap:new Map;function n(e){var t=r.get(e);if(void 0!==t)return t;var n=new Map;return Object.getOwnPropertyNames(e).forEach((function(t){n.set(e[t],t)})),r.set(e,n),n}var a=Object.freeze(Object.defineProperties(Object.create(null),{isValid:{value:function(e){return n(this).has(e)}},cast:{value:function(e){return this.isValid(e)?e:void 0}},members:{value:function(){return n(this).keys()}},getName:{value:function(e){return n(this).get(e)}}}));function s(e){var r=Object.create(a);for(var n in e)t.call(e,n)&&Object.defineProperty(r,n,{value:e[n]});return Object.freeze(r)}var o=Object.freeze(Object.defineProperties(Object.create(null),{isValid:{value:function(e){return"string"==typeof e&&t.call(this,e)}},cast:{value:a.cast},members:{value:function(){return Object.getOwnPropertyNames(this).values()}},getName:{value:function(e){return e}}}));s.Mirrored=function(e){for(var t=Object.create(o),r=0,n=e.length;r<n;++r)Object.defineProperty(t,e[r],{value:e[r]});return Object.freeze(t)},Object.freeze(s.Mirrored),e.exports=Object.freeze(s)}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}(()=>{function e(e){if(e.status>=200&&e.status<300)return e;throw e}const t=r(672)({AssetAPI:0,External:1});let n=null,a=new class{constructor(){this.loaders=new Map,this.cache=new Map}get(r,n,a){if(null==n||""===n)return Promise.resolve(null);if(a===t.External)return Promise.resolve(n);let s=this.cache.get(n);if(null!=s)return Promise.resolve(s);let o=this.loaders.get(n);return null!=o||(o=function(t,r){let n=self.origin+`/freehand/api/public/documents/${String(t)}/images/${r}/get`;return fetch(n,{credentials:"include",method:"GET",headers:{"request-source":"freehand_web"}}).then(e).then((e=>e.json())).then((e=>e.url))}(r,n).then((e=>(this.cache.set(n,e),this.loaders.delete(n),e))).catch((e=>(this.cache.delete(n),this.loaders.delete(n),null))),this.loaders.set(n,o)),o}};"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.onmessage=e=>{let t=e.data.data,r=e.data.id;a.get(t.documentID,t.assetID,t.sourceType).then((e=>{if(!e)throw new Error(`no url for assetID: '${t.assetID}'`);return async function(e){let t=await fetch(e);if(t.status>=200&&t.status<300)return await t.arrayBuffer();if(404===t.status)return null;throw new Error(`Load content failed with error code ${t.status} and error text ${t.statusText}`)}(e)})).then((e=>{self.postMessage({id:r,result:e},function(e){if(null==n){var t;let r=null==(t=e.navigator)?void 0:t.userAgent;n=!!e.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return n}(self)||null==e?void 0:[e])})).catch((e=>{self.postMessage({id:r,result:null,error:e})}))}),self})()})();